<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>克鲁斯卡尔算法 --- 加边法</title>
</head>

<body>
    <script>
        // 选择最短的边进行链接
        // 保证这个边链接的两端至少有一个点是新的点
        // 或者 这个边是将两个部落进行链接的 
        // 重复1到3 直到所有的点都连接到一起

        // 对于两个节点之间没有边的用max来表示
        var max = 1000000;
        // 点集合
        var pointSet = [];
        // 边集合
        var distance = [
            [0, 4, 7, max, max],
            [4, 0, 8, 6, max],
            [7, 8, 0, 5, max],
            [max, 6, 5, 0, 7],
            [max, max, max, 7, 0]
        ];

        function Node(value) {
            this.value = value;
            this.neighboer = [];
        }

        var a = new Node('A');
        var b = new Node('B');
        var c = new Node('C');
        var d = new Node('D');
        var e = new Node('E');

        pointSet.push(a);
        pointSet.push(b);
        pointSet.push(c);
        pointSet.push(d);
        pointSet.push(e);

        function canLink(resultList, tempBegin, tempEnd) {
            var beginIn = null;
            var endIn = null;
            for (var i = 0; i < resultList.length; i++) {
                if (resultList[i].indexOf(tempBegin) > -1) {
                    beginIn = resultList[i];
                }
                if (resultList[i].indexOf(tempEnd) > -1) {
                    endIn = resultList[i];
                }
            }
            // 两个点都是新的点，可以连接
            // begin在A部落，end没有部落，可以连接
            // end在A部落，begin没有部落，可以连接
            // 两个分别是不同的部落，可以连接
            // 两个在同一个部落，不可以连接
            if (beginIn != null && endIn != null && beginIn == endIn) {
                return false;
            }
            return true;
        }

        function link(resultList, tempBegin, tempEnd) {
            var beginIn = null;
            var endIn = null;
            for (var i = 0; i < resultList.length; i++) {
                if (resultList[i].indexOf(tempBegin) > -1) {
                    beginIn = resultList[i];
                }
                if (resultList[i].indexOf(tempEnd) > -1) {
                    endIn = resultList[i];
                }
            }
            if (beginIn == null && endIn == null) {
                var newArr = [];
                newArr.push(tempBegin);
                newArr.push(tempEnd);
                resultList.push(newArr);
            } else if (beginIn != null && endIn == null) {
                beginIn.push(tempEnd);
            } else if (beginIn == null && endIn != null) {
                endIn.push(beginIn);
            } else if (beginIn != null && endIn != null && beginIn != endIn) {
                var allIn = beginIn.concat(endIn);
                var needRemove = resultList.indexOf(endIn);
                resultList.splice(needRemove, 1);
                needRemove = resultList.indexOf(beginIn);
                resultList.splice(needRemove, 1);
                resultList.push(allIn);
            }
            tempBegin.neighboer.push(tempEnd);
            tempEnd.neighboer.push(tempBegin);
        }

        function kruskal(pointSet, distance) {
            var resultList = []; // 这里是二维数组，此数组代表的是有多少个部落
            while (true) {
                var minDis = max;
                var begin = null;
                var end = null;
                for (var i = 0; i < distance.length; i++) {
                    for (var j = 0; j < distance[i].length; j++) {
                        var tempBegin = pointSet[i];
                        var tempEnd = pointSet[j];
                        if (i != j // 去掉自己到自己 
                            &&
                            distance[i][j] < minDis &&
                            canLink(resultList, tempBegin, tempEnd)
                        ) {
                            minDis = distance[i][j];
                            begin = tempBegin;
                            end = tempEnd;
                        }
                    }
                }
                link(resultList, begin, end);
                if (resultList.length == 1 && resultList[0].length == pointSet.length) {
                    break;
                }
            }
        }

        kruskal(pointSet, distance);
        console.log(pointSet);
    </script>
</body>

</html>